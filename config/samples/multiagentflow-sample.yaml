apiVersion: agentplatform.example.com/v1
kind: MultiAgentFlow
metadata:
  name: example-flow
spec:
  agents:
    - name: agent1
      llms:
        - name: agent1-llm
          provider: ollama
          model: gemma:2b
          apiKeySecretRef: agent1-ollama-key
          parameters:
            temperature: "0.5"
      nodes:
        - id: node1
          type: llm
          llmProvider: agent1-llm
          prompt: "You are agent1. Respond to the following input: {input}"
      validation:
        - type: functional
          rule: output
      edges:
        - from: node1
          to: node1
    - name: agent2
      llms:
        - name: agent2-llm
          provider: ollama
          model: gemma:2b
          apiKeySecretRef: agent2-ollama-key
          parameters:
            temperature: "0.3"
      nodes:
        - id: node1
          type: llm
          llmProvider: agent2-llm
          prompt: "You are agent2. Respond to the following input: {input}"
      validation:
        - type: functional
          rule: status == 'completed'
      edges: []
  connections:
    - from: agent1.node1
      to: agent2.node1
  llms:
    - name: ollama-llm1
      provider: ollama
      model: gemma:2b
      apiKeySecretRef: ollama-api-key1
      parameters:
        temperature: "0.7"
    - name: ollama-llm2
      provider: ollama
      model: gemma:2b
      apiKeySecretRef: ollama-api-key2
      parameters:
        temperature: "0.5"
  logging: {}
  mcp:
    - name: global-vector-db
      type: vectorDB
      endpoint: https://vectordb.example.com
      authSecretRef: global-vector-db-secret
